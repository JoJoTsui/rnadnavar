/*
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    RNA Editing Annotation Configuration Example
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    Example configuration file for RNA editing annotation functionality.
    
    Use as follows:
        nextflow run nf-core/rnadnavar -c conf/rna_editing_example.config --input samplesheet.csv --outdir results
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
*/

params {
    // Enable RNA editing annotation
    enable_rna_annotation = true
    
    // REDIportal database configuration
    // Download from: http://srv00.recas.ba.infn.it/webshare/ATLAS/donwload/
    rediportal_vcf = "/path/to/REDIportal_hg38_v3.vcf.gz"
    rediportal_tbi = "/path/to/REDIportal_hg38_v3.vcf.gz.tbi"  // Optional: auto-generated if missing
    
    // Evidence tiering configuration
    min_rna_support = 2  // Minimum RNA caller support for HIGH evidence tier
    
    // Resource allocation for RNA editing annotation
    rna_annotation_memory = "8.GB"   // Increase for large VCF files
    rna_annotation_cpus = 4          // Increase for better performance
    
    // Advanced RNA editing options (optional)
    rna_annotation_args = "--temp-dir /tmp/rna_annotation"  // Custom temporary directory
    
    // Logging and monitoring options
    rna_annotation_log_level = "INFO"        // DEBUG for detailed logging
    rna_annotation_verbose = false           // Enable verbose output
    rna_annotation_enable_metrics = true     // Enable performance metrics
    rna_annotation_enable_performance = true // Enable performance optimizations
    rna_annotation_save_reports = false      // Save detailed processing reports
}

// Process-specific configuration for RNA editing annotation
process {
    withName: 'RNA_EDITING_ANNOTATION' {
        // Resource limits
        memory = { check_max( 8.GB * task.attempt, 'memory' ) }
        cpus = { check_max( 4 * task.attempt, 'cpus' ) }
        time = { check_max( 2.h * task.attempt, 'time' ) }
        
        // Error handling
        errorStrategy = 'retry'
        maxRetries = 2
        
        // Container options (if needed)
        // container = 'custom/rna-editing:latest'
        
        // Additional arguments
        ext.args = [
            '--verbose',
            '--enable-performance-mode',
            '--temp-dir ${TMPDIR:-/tmp}'
        ].join(' ')
        
        // Resource scaling for large datasets
        memory = { 
            if (params.wes) {
                check_max( 4.GB * task.attempt, 'memory' )
            } else {
                check_max( 16.GB * task.attempt, 'memory' )
            }
        }
    }
}

// Example configurations for different use cases

// Configuration for small/targeted datasets (WES, targeted panels)
profiles {
    rna_editing_small {
        params {
            enable_rna_annotation = true
            rna_annotation_memory = "4.GB"
            rna_annotation_cpus = 2
            min_rna_support = 2
        }
        
        process {
            withName: 'RNA_EDITING_ANNOTATION' {
                memory = { check_max( 4.GB * task.attempt, 'memory' ) }
                cpus = { check_max( 2 * task.attempt, 'cpus' ) }
                time = { check_max( 1.h * task.attempt, 'time' ) }
            }
        }
    }
    
    // Configuration for large datasets (WGS, large panels)
    rna_editing_large {
        params {
            enable_rna_annotation = true
            rna_annotation_memory = "32.GB"
            rna_annotation_cpus = 8
            min_rna_support = 3
            rna_annotation_enable_performance = true
        }
        
        process {
            withName: 'RNA_EDITING_ANNOTATION' {
                memory = { check_max( 32.GB * task.attempt, 'memory' ) }
                cpus = { check_max( 8 * task.attempt, 'cpus' ) }
                time = { check_max( 4.h * task.attempt, 'time' ) }
            }
        }
    }
    
    // Configuration for debugging and development
    rna_editing_debug {
        params {
            enable_rna_annotation = true
            rna_annotation_log_level = "DEBUG"
            rna_annotation_verbose = true
            rna_annotation_enable_metrics = true
            rna_annotation_save_reports = true
        }
        
        process {
            withName: 'RNA_EDITING_ANNOTATION' {
                // Enable detailed logging
                ext.args = [
                    '--verbose',
                    '--debug',
                    '--save-intermediate-files',
                    '--enable-detailed-metrics'
                ].join(' ')
            }
        }
    }
}

// Cluster-specific configurations
profiles {
    // SLURM cluster configuration
    slurm_rna_editing {
        process {
            withName: 'RNA_EDITING_ANNOTATION' {
                executor = 'slurm'
                queue = 'compute'
                clusterOptions = '--account=myaccount --partition=compute'
                memory = '16.GB'
                cpus = 4
                time = '2.h'
            }
        }
    }
    
    // PBS/Torque cluster configuration
    pbs_rna_editing {
        process {
            withName: 'RNA_EDITING_ANNOTATION' {
                executor = 'pbs'
                queue = 'workq'
                memory = '16gb'
                cpus = 4
                time = '02:00:00'
            }
        }
    }
}

// Cloud-specific configurations
profiles {
    // AWS Batch configuration
    aws_rna_editing {
        process {
            withName: 'RNA_EDITING_ANNOTATION' {
                memory = '16.GB'
                cpus = 4
                // Use spot instances for cost optimization
                spot = true
            }
        }
    }
    
    // Google Cloud configuration
    gcp_rna_editing {
        process {
            withName: 'RNA_EDITING_ANNOTATION' {
                memory = '16.GB'
                cpus = 4
                machineType = 'n1-standard-4'
                preemptible = true
            }
        }
    }
}